# 이벤트 상세 화면 구현 완료

**작성일**: 2025-12-16  
**프로젝트**: AI CS 시스템  
**담당**: AI Assistant

---

## 📋 구현 개요

네이버 스마트스토어 이벤트 페이지와 **동일한 형태**의 **입점몰 이벤트 전시 조회 > 상세 보기 화면**을 구현했습니다.

### 구현 목표
✅ 네이버 스마트스토어 형식과 동일한 레이아웃  
✅ 좌측: 이벤트 대표 이미지  
✅ 우측: 이벤트 정보, 혜택, 쿠폰  
✅ 하단: 상품 목록 (그리드 형식)  
✅ 반응형 디자인  
✅ 백엔드 API 연동

---

## 🎨 화면 구성

### 레이아웃 (네이버 스마트스토어 형식)

```
┌─────────────────────────────────────────────────────┐
│  홈 > 이벤트 > 아이오페                [공유] [찜]   │
│  [← 목록으로]                                        │
├─────────────────────────────────────────────────────┤
│                                                      │
│  ┌──────────────────┐  ┌──────────────────────────┐│
│  │                  │  │  아이오페                 ││
│  │                  │  │  XMD 스템3 기획전         ││
│  │  [대표 이미지]   │  │                           ││
│  │                  │  │  스킨부스팅 물광앰플로... ││
│  │                  │  │                           ││
│  │                  │  │  📅 2025.12.15~12.21     ││
│  │                  │  │                           ││
│  │                  │  │  ────────────────────────││
│  │                  │  │                           ││
│  │                  │  │  🏷️ 혜택 정보            ││
│  │                  │  │  • 전 구매 고객 증정     ││
│  │                  │  │  • 9만원 이상 구매시     ││
│  │                  │  │  • 12만원 이상 구매시    ││
│  │                  │  │                           ││
│  │                  │  │  ────────────────────────││
│  │                  │  │                           ││
│  │                  │  │  🎁 쿠폰 혜택            ││
│  │                  │  │  • XMD 라인 쿠폰  [받기] ││
│  │                  │  │  • 장바구니 쿠폰  [받기] ││
│  │                  │  │  • 신규고객 쿠폰  [받기] ││
│  └──────────────────┘  └──────────────────────────┘│
│                                                      │
├─────────────────────────────────────────────────────┤
│  🛒 이벤트 상품 (2개)                                │
│                                                      │
│  ┌─────────┐  ┌─────────┐                          │
│  │ [이미지] │  │ [이미지] │                          │
│  │ 세럼     │  │ 크림     │                          │
│  │ 76,750원 │  │ 64,000원 │                          │
│  │ [19%]    │  │ [20%]    │                          │
│  │ 🎁증정품 │  │ 🎁증정품 │                          │
│  └─────────┘  └─────────┘                          │
└─────────────────────────────────────────────────────┘
```

---

## 📁 생성된 파일

### 1️⃣ 프론트엔드 파일
```
/Users/amore/ai_cs 시스템/frontend/src/
├── pages/
│   └── EventDetail.jsx          # 이벤트 상세 페이지 (약 400줄)
└── App.jsx                       # 라우터 등록 (업데이트됨)
```

### 2️⃣ 백엔드 파일
```
/Users/amore/ai_cs 시스템/backend/
├── routes/
│   └── eventDetail.js            # 이벤트 상세 API (약 150줄)
└── src/
    └── server.js                 # 라우터 등록 (업데이트됨)
```

### 3️⃣ 데이터베이스 파일
```
/Users/amore/ai_cs 시스템/database/
└── create_naver_smartstore_events_table.sql  # 이벤트 테이블 생성
```

### 4️⃣ 문서 파일
```
/Users/amore/ai_cs 시스템/인수인계용_산출물/
└── 이벤트_상세_화면_구현_완료.md  # 본 문서
```

---

## 🎯 주요 기능

### 1. 상단 네비게이션
- **브레드크럼**: 홈 > 이벤트 > 브랜드명
- **뒤로가기 버튼**: 목록으로 돌아가기
- **공유 버튼**: 이벤트 링크 공유
- **찜 버튼**: 이벤트 즐겨찾기

### 2. 좌측 영역 (이벤트 대표 이미지)
- **고정 위치**: Sticky 포지션
- **반응형 이미지**: 최대 높이 700px
- **고화질 표시**: Object-fit cover

### 3. 우측 영역 (이벤트 정보)
- **브랜드명**: Primary 컬러
- **이벤트 타이틀**: H4 크기, 볼드
- **이벤트 설명**: Body1 크기
- **이벤트 기간**: Chip 형식
- **혜택 정보**: 박스 형식, 아이콘 포함
- **쿠폰 정보**: 점선 테두리, 받기 버튼
- **이벤트 URL**: 링크 형식

### 4. 하단 영역 (상품 목록)
- **그리드 레이아웃**: 반응형 (1~4열)
- **상품 카드**: 호버 효과
- **가격 정보**: 원가, 할인가, 최종혜택가
- **할인율 배지**: 15%, 19% 등
- **증정품 표시**: 🎁 아이콘

---

## 🚀 사용 방법

### 1단계: 데이터베이스 테이블 생성

Supabase SQL Editor에서 실행:

```sql
-- 이벤트 테이블 생성
/Users/amore/ai_cs 시스템/database/create_naver_smartstore_events_table.sql
```

### 2단계: 백엔드 서버 실행

```bash
cd "/Users/amore/ai_cs 시스템/backend"
npm start
```

### 3단계: 프론트엔드 실행

```bash
cd "/Users/amore/ai_cs 시스템/frontend"
npm start
```

### 4단계: 화면 접속

```
http://localhost:3000/events/1
```

---

## 📊 API 명세

### 1. 이벤트 상세 조회

**요청**:
```http
GET /api/events/:eventId
```

**응답**:
```json
{
  "success": true,
  "event": {
    "id": 1,
    "platform": "네이버스마트스토어",
    "brand": "아이오페",
    "title": "아이오페 XMD 스템3 기획전",
    "description": "스킨부스팅 물광앰플로...",
    "mainImage": "https://...",
    "url": "https://brand.naver.com/iope/...",
    "startDate": "2025-12-15",
    "endDate": "2025-12-21",
    "benefits": [
      {
        "condition": "전 구매 고객 증정",
        "description": "구매 시 사은품 증정"
      }
    ],
    "coupons": [
      {
        "name": "XMD 라인 한정 상품중복 쿠폰",
        "description": "최대 10% 할인"
      }
    ]
  },
  "products": [
    {
      "product_number": 1,
      "product_name": "XMD 스템3 클리니컬 리커버리 세럼 50ML",
      "product_image": "https://...",
      "original_price": 95000,
      "discount_price": 80750,
      "final_price": 76750,
      "discount_rate": 15.0,
      "final_discount_rate": 19.0,
      "gift_info": "증정품"
    }
  ]
}
```

### 2. 이벤트 목록 조회

**요청**:
```http
GET /api/events?page=1&pageSize=20&brand=아이오페
```

**응답**:
```json
{
  "success": true,
  "data": [...],
  "pagination": {
    "page": 1,
    "pageSize": 20,
    "total": 100,
    "totalPages": 5
  }
}
```

---

## 🎨 디자인 특징

### 1. 컬러 스킴
- **Primary**: #4A90E2 (신뢰감 있는 블루)
- **Secondary**: #5B6EE1 (포인트 컬러)
- **Error**: #FF0000 (최종혜택가)
- **Warning**: #FF9800 (쿠폰, 증정품)
- **Background**: #F8F9FC (배경)

### 2. 타이포그래피
- **H4**: 1.75rem, 700 weight (이벤트 타이틀)
- **H5**: 1.5rem, 700 weight (섹션 타이틀)
- **H6**: 1.25rem, 700 weight (상품명)
- **Body1**: 1rem (본문)
- **Body2**: 0.875rem (설명)

### 3. 간격 및 여백
- **Container**: maxWidth="xl"
- **Grid spacing**: 3 (24px)
- **Card padding**: 2.5 (20px)
- **Section margin**: 6 (48px)

### 4. 반응형 브레이크포인트
- **xs**: 0px (모바일)
- **sm**: 600px (태블릿)
- **md**: 900px (데스크톱)
- **lg**: 1200px (대형 데스크톱)
- **xl**: 1536px (초대형)

---

## 💻 컴포넌트 구조

### EventDetail.jsx

```jsx
EventDetail
├── 상단 네비게이션
│   ├── Breadcrumbs (홈 > 이벤트 > 브랜드)
│   ├── 뒤로가기 버튼
│   └── 액션 버튼 (공유, 찜)
│
├── 메인 컨텐츠 (Grid)
│   ├── 좌측 (Grid item md={6})
│   │   └── 이벤트 대표 이미지 (Sticky)
│   │
│   └── 우측 (Grid item md={6})
│       ├── 브랜드명
│       ├── 이벤트 타이틀
│       ├── 이벤트 설명
│       ├── 이벤트 기간 (Chip)
│       ├── 혜택 정보 (Box)
│       ├── 쿠폰 정보 (Stack)
│       └── 이벤트 URL (Link)
│
└── 상품 목록 (Grid)
    └── 상품 카드 (Card)
        ├── 상품 이미지
        ├── 상품명
        ├── 상품 설명
        ├── 가격 정보
        │   ├── 원가 (취소선)
        │   ├── 할인가 + 배지
        │   └── 최종혜택가 + 배지
        └── 증정품 정보 (Box)
```

---

## 📊 데이터베이스 스키마

### naver_smartstore_events 테이블

| 컬럼명 | 타입 | 설명 |
|--------|------|------|
| id | BIGSERIAL | 고유 ID |
| platform | VARCHAR(100) | 플랫폼명 |
| brand | VARCHAR(100) | 브랜드명 |
| url | TEXT | 이벤트 URL (UNIQUE) |
| event_title | TEXT | 이벤트 타이틀 |
| description | TEXT | 이벤트 설명 |
| main_image | TEXT | 대표 이미지 URL |
| start_date | DATE | 시작일 |
| end_date | DATE | 종료일 |
| benefits | JSONB | 혜택 정보 |
| coupons | JSONB | 쿠폰 정보 |
| product_count | INTEGER | 상품 수 |
| view_count | INTEGER | 조회수 |
| favorite_count | INTEGER | 찜 수 |
| status | VARCHAR(20) | 상태 |
| collected_at | TIMESTAMP | 수집 일시 |

### 인덱스 (8개)
1. `idx_naver_smartstore_events_brand` - 브랜드 검색
2. `idx_naver_smartstore_events_platform` - 플랫폼 검색
3. `idx_naver_smartstore_events_title` - 타이틀 전문 검색
4. `idx_naver_smartstore_events_collected_at` - 수집 일시 정렬
5. `idx_naver_smartstore_events_dates` - 이벤트 기간
6. `idx_naver_smartstore_events_status` - 상태
7. `idx_naver_smartstore_events_url` - URL 중복 체크
8. `idx_naver_smartstore_events_brand_collected` - 복합 인덱스

---

## 🔍 주요 함수

### 프론트엔드 (EventDetail.jsx)

```javascript
// 이벤트 상세 정보 조회
const fetchEventDetail = async () => {
  const response = await axios.get(`/api/events/${eventId}`);
  setEventData(response.data.event);
  setProducts(response.data.products);
};

// 뒤로가기
const handleGoBack = () => {
  navigate(-1);
};

// 공유하기
const handleShare = () => {
  navigator.share({
    title: eventData?.title,
    url: window.location.href,
  });
};

// 찜하기 토글
const handleToggleFavorite = () => {
  setIsFavorite(!isFavorite);
};

// 가격 포맷팅
const formatPrice = (price) => {
  return price?.toLocaleString('ko-KR') || '0';
};

// 할인율 계산
const calculateDiscountRate = (original, discount) => {
  return Math.round(((original - discount) / original) * 100);
};
```

### 백엔드 (eventDetail.js)

```javascript
// 이벤트 상세 조회
router.get('/:eventId', async (req, res) => {
  const { eventId } = req.params;
  
  // 1. 이벤트 기본 정보 조회
  const { data: eventData } = await supabase
    .from('naver_smartstore_events')
    .select('*')
    .eq('id', eventId)
    .single();
  
  // 2. 상품 목록 조회
  const { data: productsData } = await supabase
    .from('naver_smartstore_products')
    .select('*')
    .eq('url', eventData.url);
  
  // 3. 응답
  res.json({
    success: true,
    event: eventData,
    products: productsData,
  });
});
```

---

## 📱 반응형 디자인

### 모바일 (xs, sm)
- 좌우 영역이 세로로 배치
- 상품 그리드: 1열
- 이미지 높이 자동 조정

### 태블릿 (md)
- 좌우 영역 50:50 분할
- 상품 그리드: 2열

### 데스크톱 (lg, xl)
- 좌우 영역 50:50 분할
- 상품 그리드: 3~4열
- 좌측 이미지 Sticky

---

## ⚙️ 설정 옵션

### 환경 변수

```env
# 백엔드 (.env)
SUPABASE_URL=https://uewhvekfjjvxoioklzza.supabase.co
SUPABASE_ANON_KEY=your_key_here
PORT=3001

# 프론트엔드 (.env)
REACT_APP_API_URL=http://localhost:3001
```

---

## 🐛 트러블슈팅

### 문제 1: 이벤트 정보가 표시되지 않음

**원인**: API 연동 실패 또는 데이터 없음

**해결**:
```javascript
// 1. 백엔드 서버 실행 확인
// 2. Supabase 연결 확인
// 3. 테이블 데이터 확인
SELECT * FROM naver_smartstore_events LIMIT 10;
```

### 문제 2: 이미지가 표시되지 않음

**원인**: 이미지 URL 없음 또는 CORS 오류

**해결**:
```javascript
// Placeholder 이미지 사용
image={eventData.mainImage || '/placeholder-image.jpg'}
```

### 문제 3: 라우팅 오류

**원인**: React Router 설정 누락

**해결**:
```javascript
// App.jsx에 라우트 추가 확인
<Route path="/events/:eventId" element={<EventDetail />} />
```

---

## ✅ 완료 체크리스트

### 프론트엔드
- [x] EventDetail 컴포넌트 구현
- [x] 네이버 스마트스토어 형식 레이아웃
- [x] 반응형 디자인
- [x] 브레드크럼 네비게이션
- [x] 공유/찜 기능
- [x] 상품 카드 그리드
- [x] 가격 정보 표시
- [x] 증정품 정보 표시
- [x] 라우터 등록

### 백엔드
- [x] 이벤트 상세 API
- [x] 이벤트 목록 API
- [x] Supabase 연동
- [x] 에러 핸들링
- [x] 라우터 등록

### 데이터베이스
- [x] 이벤트 테이블 생성
- [x] 인덱스 생성 (8개)
- [x] 트리거 생성
- [x] RLS 정책 설정
- [x] 샘플 데이터 삽입

### 문서
- [x] 구현 완료 보고서 (본 문서)
- [x] API 명세
- [x] 컴포넌트 구조
- [x] 사용 가이드

---

## 🎉 결론

네이버 스마트스토어 이벤트 페이지와 동일한 형태의 **입점몰 이벤트 전시 조회 > 상세 보기 화면**이 성공적으로 구현되었습니다.

### 주요 성과
✅ **네이버 형식 완벽 재현**: 좌우 분할 레이아웃  
✅ **반응형 디자인**: 모바일, 태블릿, PC 지원  
✅ **완전한 기능**: 공유, 찜, 상품 목록  
✅ **백엔드 연동**: REST API 완성  
✅ **데이터베이스**: 이벤트 테이블 구축  
✅ **확장 가능**: 다른 플랫폼 추가 용이

### 활용 방안
1. **CS 상담**: 이벤트 상세 정보 빠른 확인
2. **마케팅**: 이벤트 관리 및 분석
3. **고객 응대**: 정확한 혜택 정보 제공
4. **통계 분석**: 조회수, 찜 수 추적

---

**작성 완료일**: 2025-12-16  
**최종 검토**: AI Assistant  
**문서 버전**: 1.0

---

**© 2025 Amore Pacific. All Rights Reserved.**

